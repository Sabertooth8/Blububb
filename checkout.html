<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - Blububb Pastry'n Cake</title>
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="logo.png">
    <meta name="description" content="Selesaikan pesanan kue Blububb kamu dengan mudah dan cepat!">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Fredoka:wght@300;400;500;600&family=Poppins:wght@300;400;500;600&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body>

    <!-- Navbar -->
    <nav class="navbar">
        <div class="container nav-container">
            <a href="index.html" class="logo"><img src="logo.png" alt="Blububb" class="logo-img"></a>
            <ul class="nav-links">
                <li><a href="index.html">Home</a></li>
                <li><a href="index.html#best-seller">Best Seller</a></li>
                <li><a href="catalog.html">Katalog</a></li>
                <li><a href="index.html#testimoni">Testimoni</a></li>
                <li><a href="index.html#contact" class="btn-nav">Order Now</a></li>
            </ul>
            <div class="nav-actions">
                <button class="cart-btn" id="cartToggle">
                    <i class="fas fa-shopping-bag"></i>
                    <span class="cart-badge" id="cartBadge" style="display: none;">0</span>
                </button>
                <div class="hamburger">
                    <i class="fas fa-bars"></i>
                </div>
            </div>
        </div>
    </nav>

    <!-- Checkout Section -->
    <section class="checkout-page">
        <div class="container">
            <!-- Progress Steps -->
            <div class="checkout-steps">
                <div class="checkout-step active" id="step1Indicator">
                    <span class="step-number">1</span>
                    <span>Keranjang</span>
                </div>
                <div class="step-connector"></div>
                <div class="checkout-step" id="step2Indicator">
                    <span class="step-number">2</span>
                    <span>Data Diri</span>
                </div>
                <div class="step-connector"></div>
                <div class="checkout-step" id="step3Indicator">
                    <span class="step-number">3</span>
                    <span>Konfirmasi</span>
                </div>
            </div>

            <!-- Step 1: Cart Summary -->
            <div class="checkout-step-content" id="step1">
                <div class="checkout-card">
                    <h3>üõí Ringkasan Pesanan</h3>

                    <!-- Empty Cart State -->
                    <div class="checkout-empty" id="checkoutEmpty" style="display: none;">
                        <i class="fas fa-shopping-bag"></i>
                        <h4>Keranjang Kosong</h4>
                        <p>Silakan tambahkan produk terlebih dahulu</p>
                        <a href="catalog.html" class="btn btn-primary">
                            <i class="fas fa-arrow-left"></i> Lihat Katalog
                        </a>
                    </div>

                    <!-- Cart Items -->
                    <div class="checkout-items" id="checkoutItems"></div>

                    <!-- Cart Total -->
                    <div class="checkout-total" id="checkoutTotal" style="display: none;">
                        <div class="total-row">
                            <span>Subtotal</span>
                            <span id="subtotalValue">Rp 0</span>
                        </div>
                        <div class="total-row final">
                            <span>Total</span>
                            <span id="totalValue">Rp 0</span>
                        </div>
                    </div>
                </div>

                <button class="btn btn-primary btn-next" id="toStep2" style="display: none;">
                    Lanjut ke Data Diri <i class="fas fa-arrow-right"></i>
                </button>
            </div>

            <!-- Step 2: Customer Info -->
            <div class="checkout-step-content" id="step2" style="display: none;">
                <div class="checkout-card">
                    <h3>üìã Data Pemesan</h3>
                    <form id="customerForm">
                        <div class="form-group">
                            <label for="nama">Nama Lengkap <span class="required">*</span></label>
                            <input type="text" id="nama" name="nama" placeholder="Masukkan nama lengkap" required>
                        </div>

                        <div class="form-group">
                            <label for="whatsapp">Nomor WhatsApp <span class="required">*</span></label>
                            <input type="tel" id="whatsapp" name="whatsapp" placeholder="08xxxxxxxxxx" required>
                        </div>

                        <div class="form-group">
                            <label for="alamat">Alamat Pengambilan/Pengiriman <span class="required">*</span></label>
                            <textarea id="alamat" name="alamat" rows="3" placeholder="Masukkan alamat lengkap"
                                required></textarea>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="tanggal">Tanggal Ambil/Kirim <span class="required">*</span></label>
                                <input type="date" id="tanggal" name="tanggal" required>
                            </div>
                            <div class="form-group">
                                <label for="waktu">Waktu</label>
                                <select id="waktu" name="waktu">
                                    <option value="pagi">Pagi (08:00 - 12:00)</option>
                                    <option value="siang">Siang (12:00 - 15:00)</option>
                                    <option value="sore">Sore (15:00 - 18:00)</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="catatan">Catatan (Opsional)</label>
                            <input type="text" id="catatan" name="catatan"
                                placeholder="Tulisan di kue, request khusus, dll">
                        </div>
                    </form>
                </div>

                <div class="checkout-card">
                    <h3>üí≥ Metode Pembayaran</h3>
                    <div class="payment-methods">
                        <div class="payment-option selected" data-method="transfer">
                            <i class="fas fa-university"></i>
                            <span>Transfer Bank</span>
                        </div>
                        <div class="payment-option" data-method="cod">
                            <i class="fas fa-money-bill-wave"></i>
                            <span>Bayar di Tempat</span>
                        </div>
                        <div class="payment-option" data-method="qris">
                            <i class="fas fa-qrcode"></i>
                            <span>QRIS</span>
                        </div>
                    </div>
                </div>

                <div class="checkout-nav">
                    <button class="btn btn-secondary" id="backToStep1">
                        <i class="fas fa-arrow-left"></i> Kembali
                    </button>
                    <button class="btn btn-primary" id="toStep3">
                        Review Pesanan <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>

            <!-- Step 3: Confirmation -->
            <div class="checkout-step-content" id="step3" style="display: none;">
                <div class="checkout-card confirmation-card">
                    <h3>‚úÖ Konfirmasi Pesanan</h3>

                    <div class="confirmation-section">
                        <h4>üì¶ Pesanan</h4>
                        <div id="confirmationItems"></div>
                        <div class="confirmation-total">
                            <span>Total Pembayaran</span>
                            <span class="total-amount" id="confirmTotal">Rp 0</span>
                        </div>
                    </div>

                    <div class="confirmation-section">
                        <h4>üë§ Data Pemesan</h4>
                        <div class="confirmation-data" id="confirmCustomer"></div>
                    </div>

                    <div class="confirmation-section">
                        <h4>üí≥ Pembayaran</h4>
                        <div class="confirmation-data" id="confirmPayment"></div>
                    </div>
                </div>

                <!-- Trust Badges -->
                <div class="trust-badges-checkout">
                    <div class="trust-item">
                        <i class="fas fa-shield-alt"></i>
                        <span>Aman</span>
                    </div>
                    <div class="trust-item">
                        <i class="fas fa-star"></i>
                        <span>Fresh</span>
                    </div>
                    <div class="trust-item">
                        <i class="fas fa-bolt"></i>
                        <span>Fast Response</span>
                    </div>
                </div>

                <div class="checkout-nav">
                    <button class="btn btn-secondary" id="backToStep2">
                        <i class="fas fa-arrow-left"></i> Kembali
                    </button>
                    <button class="btn btn-whatsapp" id="submitOrder">
                        <i class="fab fa-whatsapp"></i> Kirim Pesanan
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container footer-content">
            <div class="footer-brand">
                <h3>Blububb Pastry'n Cake üßÅ</h3>
                <p>Oleh: Cindy Agustina Putri</p>
                <p>Sweet treats made with love.</p>
            </div>
            <div class="footer-links">
                <a href="#"><i class="fab fa-instagram"></i></a>
                <a href="#"><i class="fab fa-tiktok"></i></a>
                <a href="#"><i class="fab fa-whatsapp"></i></a>
            </div>
        </div>
        <div class="footer-bottom text-center">
            <p>&copy; 2024 Blububb Pastry'n Cake. All rights reserved.</p>
        </div>
    </footer>

    <!-- Cart Drawer (hidden on checkout) -->
    <div class="cart-overlay" id="cartOverlay"></div>
    <div class="cart-drawer" id="cartDrawer">
        <div class="cart-drawer-header">
            <h2>üõí Keranjang</h2>
            <button class="cart-close" id="cartClose"><i class="fas fa-times"></i></button>
        </div>
        <div class="cart-empty" id="cartEmpty">
            <i class="fas fa-shopping-bag"></i>
            <h3>Keranjang Kosong</h3>
            <p>Yuk, pilih kue favoritmu!</p>
        </div>
        <div class="cart-content" id="cartContent"></div>
        <div class="cart-footer" id="cartFooter" style="display: none;">
            <div class="cart-total-row">
                <span>Total</span>
                <span class="cart-total-price" id="cartTotal">Rp 0</span>
            </div>
            <a href="checkout.html" class="btn-checkout">
                <i class="fas fa-credit-card"></i> Checkout Sekarang
            </a>
        </div>
    </div>

    <script src="cart.js"></script>
    <script>
        // ==============================
        // CHECKOUT PAGE FUNCTIONALITY (Static - No Backend Required)
        // ==============================

        let currentStep = 1;
        let selectedPayment = 'transfer';
        let orderData = {};

        // Hamburger Menu Toggle
        const hamburger = document.querySelector('.hamburger');
        const navLinks = document.querySelector('.nav-links');
        if (hamburger) {
            hamburger.addEventListener('click', () => {
                navLinks.classList.toggle('active');
                hamburger.classList.toggle('active');
            });
        }

        // Format price
        function formatPrice(price) {
            return 'Rp ' + price.toLocaleString('id-ID');
        }

        // Set minimum date to tomorrow
        const tomorrow = new Date();
        tomorrow.setDate(tomorrow.getDate() + 1);
        document.getElementById('tanggal').min = tomorrow.toISOString().split('T')[0];

        // Load cart and render
        function loadCartItems() {
            const cart = CartManager.getCart();
            const itemsContainer = document.getElementById('checkoutItems');
            const emptyState = document.getElementById('checkoutEmpty');
            const totalSection = document.getElementById('checkoutTotal');
            const nextBtn = document.getElementById('toStep2');

            if (cart.items.length === 0) {
                itemsContainer.innerHTML = '';
                emptyState.style.display = 'flex';
                totalSection.style.display = 'none';
                nextBtn.style.display = 'none';
                return;
            }

            emptyState.style.display = 'none';
            totalSection.style.display = 'block';
            nextBtn.style.display = 'flex';

            itemsContainer.innerHTML = cart.items.map(item => `
                <div class="checkout-item">
                    <img src="${item.image}" alt="${item.name}">
                    <div class="checkout-item-info">
                        <h4>${item.name}</h4>
                        <p class="item-price">${formatPrice(item.price)}</p>
                    </div>
                    <div class="checkout-item-qty">
                        <button class="qty-btn" onclick="updateQty('${item.id}', ${item.quantity - 1})">‚àí</button>
                        <span>${item.quantity}</span>
                        <button class="qty-btn" onclick="updateQty('${item.id}', ${item.quantity + 1})">+</button>
                    </div>
                    <div class="checkout-item-subtotal">
                        ${formatPrice(item.subtotal)}
                    </div>
                    <button class="remove-item" onclick="removeItem('${item.id}')">
                        <i class="fas fa-trash-alt"></i>
                    </button>
                </div>
            `).join('');

            document.getElementById('subtotalValue').textContent = formatPrice(cart.total);
            document.getElementById('totalValue').textContent = formatPrice(cart.total);
        }

        function updateQty(id, qty) {
            CartManager.updateQty(id, qty);
            loadCartItems();
        }

        function removeItem(id) {
            CartManager.remove(id);
            loadCartItems();
        }

        // Step navigation
        function goToStep(step) {
            currentStep = step;

            // Hide all steps
            document.querySelectorAll('.checkout-step-content').forEach(el => {
                el.style.display = 'none';
            });

            // Show current step
            document.getElementById(`step${step}`).style.display = 'block';

            // Update indicators
            document.querySelectorAll('.checkout-step').forEach((el, i) => {
                el.classList.remove('active', 'completed');
                if (i + 1 < step) {
                    el.classList.add('completed');
                } else if (i + 1 === step) {
                    el.classList.add('active');
                }
            });

            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Payment method selection
        document.querySelectorAll('.payment-option').forEach(option => {
            option.addEventListener('click', () => {
                document.querySelectorAll('.payment-option').forEach(o => o.classList.remove('selected'));
                option.classList.add('selected');
                selectedPayment = option.dataset.method;
            });
        });

        // Navigation buttons
        document.getElementById('toStep2').addEventListener('click', () => {
            goToStep(2);
        });

        document.getElementById('backToStep1').addEventListener('click', () => {
            goToStep(1);
        });

        document.getElementById('toStep3').addEventListener('click', () => {
            // Validate form
            const form = document.getElementById('customerForm');
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }

            // Store order data
            orderData = {
                nama: document.getElementById('nama').value,
                whatsapp: document.getElementById('whatsapp').value,
                alamat: document.getElementById('alamat').value,
                tanggal: document.getElementById('tanggal').value,
                waktu: document.getElementById('waktu').value,
                catatan: document.getElementById('catatan').value,
                payment: selectedPayment
            };

            // Render confirmation
            renderConfirmation();
            goToStep(3);
        });

        document.getElementById('backToStep2').addEventListener('click', () => {
            goToStep(2);
        });

        // Render confirmation
        function renderConfirmation() {
            const cart = CartManager.getCart();

            // Items summary
            document.getElementById('confirmationItems').innerHTML = cart.items.map(item => `
                <div class="confirm-item">
                    <span>${item.name} x${item.quantity}</span>
                    <span>${formatPrice(item.subtotal)}</span>
                </div>
            `).join('');

            document.getElementById('confirmTotal').textContent = formatPrice(cart.total);

            // Customer data
            const formattedDate = new Date(orderData.tanggal).toLocaleDateString('id-ID', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });

            const waktuLabels = {
                pagi: 'Pagi (08:00 - 12:00)',
                siang: 'Siang (12:00 - 15:00)',
                sore: 'Sore (15:00 - 18:00)'
            };

            document.getElementById('confirmCustomer').innerHTML = `
                <p><strong>Nama:</strong> ${orderData.nama}</p>
                <p><strong>WhatsApp:</strong> ${orderData.whatsapp}</p>
                <p><strong>Alamat:</strong> ${orderData.alamat}</p>
                <p><strong>Tanggal:</strong> ${formattedDate}</p>
                <p><strong>Waktu:</strong> ${waktuLabels[orderData.waktu]}</p>
                ${orderData.catatan ? `<p><strong>Catatan:</strong> ${orderData.catatan}</p>` : ''}
            `;

            // Payment
            const paymentLabels = {
                transfer: 'Transfer Bank',
                cod: 'Bayar di Tempat (COD)',
                qris: 'QRIS'
            };

            document.getElementById('confirmPayment').innerHTML = `
                <p>${paymentLabels[orderData.payment]}</p>
            `;
        }

        // Submit order
        document.getElementById('submitOrder').addEventListener('click', () => {
            const cart = CartManager.getCart();

            // Create WhatsApp message
            const formattedDate = new Date(orderData.tanggal).toLocaleDateString('id-ID', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });

            let message = `üéÇ *ORDER BLUBUBB*\n\n`;
            message += `*Pesanan:*\n`;
            cart.items.forEach(item => {
                message += `‚Ä¢ ${item.name} x${item.quantity} = ${formatPrice(item.subtotal)}\n`;
            });
            message += `\n*Total: ${formatPrice(cart.total)}*\n\n`;
            message += `*Data Pemesan:*\n`;
            message += `Nama: ${orderData.nama}\n`;
            message += `WhatsApp: ${orderData.whatsapp}\n`;
            message += `Alamat: ${orderData.alamat}\n`;
            message += `Tanggal: ${formattedDate}\n`;
            message += `Pembayaran: ${orderData.payment === 'transfer' ? 'Transfer Bank' : orderData.payment === 'cod' ? 'COD' : 'QRIS'}\n`;
            if (orderData.catatan) {
                message += `Catatan: ${orderData.catatan}\n`;
            }
            message += `\nTerima kasih sudah order di Blububb! üíï`;

            // Clear cart
            CartManager.clear();

            // Redirect to WhatsApp
            const waNumber = '6282181081501'; // Blububb WhatsApp
            const waURL = `https://wa.me/${waNumber}?text=${encodeURIComponent(message)}`;
            window.open(waURL, '_blank');

            // Show success (optional: redirect to confirmation page)
            alert('Pesanan berhasil dikirim! Silakan lanjutkan di WhatsApp.');
            window.location.href = 'index.html';
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            loadCartItems();
        });
    </script>

    <style>
        /* Checkout-specific styles */
        .checkout-page {
            padding-top: 120px;
            padding-bottom: 60px;
            min-height: 100vh;
            background: var(--bg-cream);
        }

        .checkout-step-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .checkout-empty {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 50px 20px;
            color: var(--text-secondary);
        }

        .checkout-empty i {
            font-size: 4rem;
            color: var(--soft-pink);
            margin-bottom: 20px;
            opacity: 0.6;
        }

        .checkout-empty h4 {
            color: var(--text-secondary);
            margin-bottom: 10px;
        }

        .checkout-empty p {
            margin-bottom: 20px;
        }

        .checkout-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: var(--bg-cream);
            border-radius: 16px;
            margin-bottom: 12px;
        }

        .checkout-item img {
            width: 70px;
            height: 70px;
            object-fit: cover;
            border-radius: 12px;
        }

        .checkout-item-info {
            flex: 1;
        }

        .checkout-item-info h4 {
            font-size: 1rem;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .checkout-item-info .item-price {
            color: var(--deep-pink);
            font-weight: 600;
            font-size: 0.9rem;
        }

        .checkout-item-qty {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .checkout-item-subtotal {
            font-weight: 700;
            color: var(--text-primary);
            min-width: 100px;
            text-align: right;
        }

        .remove-item {
            background: transparent;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 8px;
            opacity: 0.5;
            transition: all 0.2s;
        }

        .remove-item:hover {
            opacity: 1;
            color: #e74c3c;
        }

        .checkout-total {
            border-top: 2px solid var(--bg-cream);
            padding-top: 20px;
            margin-top: 10px;
        }

        .total-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: var(--text-secondary);
        }

        .total-row.final {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--deep-pink);
            padding-top: 10px;
            border-top: 1px dashed var(--soft-pink);
        }

        .btn-next {
            width: 100%;
            margin-top: 20px;
            justify-content: center;
            gap: 10px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-primary);
        }

        .form-group .required {
            color: var(--deep-pink);
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 14px 18px;
            border: 2px solid #eee;
            border-radius: 12px;
            font-size: 1rem;
            font-family: var(--font-body);
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--soft-pink);
            box-shadow: 0 0 0 4px rgba(255, 196, 214, 0.2);
        }

        .checkout-nav {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }

        .checkout-nav .btn {
            flex: 1;
            justify-content: center;
        }

        /* Confirmation styles */
        .confirmation-section {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }

        .confirmation-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        .confirmation-section h4 {
            font-size: 1rem;
            color: var(--deep-pink);
            margin-bottom: 15px;
        }

        .confirm-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            color: var(--text-secondary);
        }

        .confirmation-total {
            display: flex;
            justify-content: space-between;
            padding-top: 15px;
            margin-top: 10px;
            border-top: 1px dashed var(--soft-pink);
        }

        .confirmation-total .total-amount {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--deep-pink);
        }

        .confirmation-data p {
            margin-bottom: 8px;
            color: var(--text-secondary);
        }

        .confirmation-data strong {
            color: var(--text-primary);
        }

        .trust-badges-checkout {
            display: flex;
            justify-content: center;
            gap: 30px;
            padding: 25px;
            background: white;
            border-radius: 20px;
            margin: 20px 0;
        }

        .trust-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            color: var(--text-secondary);
        }

        .trust-item i {
            font-size: 1.5rem;
            color: var(--deep-pink);
        }

        .trust-item span {
            font-size: 0.85rem;
            font-weight: 500;
        }

        @media (max-width: 600px) {
            .form-row {
                grid-template-columns: 1fr;
            }

            .checkout-item {
                flex-wrap: wrap;
            }

            .checkout-item-subtotal {
                width: 100%;
                text-align: left;
                padding-top: 10px;
            }

            .checkout-nav {
                flex-direction: column;
            }

            .trust-badges-checkout {
                flex-wrap: wrap;
            }
        }
    </style>
</body>

</html>